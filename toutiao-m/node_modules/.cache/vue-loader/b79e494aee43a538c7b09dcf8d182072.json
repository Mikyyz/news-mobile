{"remainingRequest":"/Users/mikyyz/vue-trip/toutiao-m/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mikyyz/vue-trip/toutiao-m/src/views/login/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mikyyz/vue-trip/toutiao-m/src/views/login/index.vue","mtime":1601834791116},{"path":"/Users/mikyyz/vue-trip/toutiao-m/node_modules/cache-loader/dist/cjs.js","mtime":1599750694245},{"path":"/Users/mikyyz/vue-trip/toutiao-m/node_modules/babel-loader/lib/index.js","mtime":1590300945779},{"path":"/Users/mikyyz/vue-trip/toutiao-m/node_modules/cache-loader/dist/cjs.js","mtime":1599750694245},{"path":"/Users/mikyyz/vue-trip/toutiao-m/node_modules/vue-loader/lib/index.js","mtime":1599750700770}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGxvZ2luLCBzZW5kU21zIH0gZnJvbSAnQC9hcGkvdXNlcic7CiAgICBleHBvcnQgZGVmYXVsdCB7CiAgICAgICAgbmFtZTogJ2xvZ2luJywKICAgICAgICBkYXRhKCkgewogICAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICAgICAgdGltZTogMTAwMCAqIDYwLAogICAgICAgICAgICAgICAgaXNDb3VudGRvd25TaG93OiBmYWxzZSwKICAgICAgICAgICAgICAgIGlzQnV0dG9uRGlzYWJsZWQ6IGZhbHNlLAogICAgICAgICAgICAgICAgdXNlcjogewogICAgICAgICAgICAgICAgICAgIG1vYmlsZTogJycsCiAgICAgICAgICAgICAgICAgICAgY29kZTogJycKICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICBmb3JtUnVsZXM6IHsKICAgICAgICAgICAgICAgICAgICBtb2JpbGU6IFsKICAgICAgICAgICAgICAgICAgICAgICAgeyByZXF1aXJlZDogdHJ1ZSwgbWVzc2FnZTogJ+ivt+i+k+WFpeaJi+acuuWPtycgfSwKICAgICAgICAgICAgICAgICAgICAgICAgeyBwYXR0ZXJuOiAvXjFbMzQ1NzhdXGR7OX0kLywgbWVzc2FnZTogJ+aJi+acuuWPt+agvOW8j+mUmeivrycgfQogICAgICAgICAgICAgICAgICAgIF0sCiAgICAgICAgICAgICAgICAgICAgY29kZTogWwogICAgICAgICAgICAgICAgICAgICAgICB7IHJlcXVpcmVkOiB0cnVlLCBtZXNzYWdlOiAn6K+36L6T5YWlNuS9jemqjOivgeeggScgfSwKICAgICAgICAgICAgICAgICAgICAgICAgeyBwYXR0ZXJuOiAvXlxkezZ9JC8sIG1lc3NhZ2U6ICfpqozor4HnoIHkuLo25L2N5pWw5a2XJyB9CiAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBtZXRob2RzOiB7CiAgICAgICAgICAgYXN5bmMgb25Mb2dpbigpIHsKCiAgICAgICAgICAgICAgIHRoaXMuJHRvYXN0LmxvYWRpbmcoewogICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ+eZu+W9leS4rS4uLicsCiAgICAgICAgICAgICAgICAgICBmb3JiaWRDbGljazogdHJ1ZSwKICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAwCiAgICAgICAgICAgICAgIH0pCgogICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBsb2dpbih0aGlzLnVzZXIpOwogICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZyhyZXMpOwogICAgICAgICAgICAgICAgICAgdGhpcy4kdG9hc3Quc3VjY2Vzcygn55m75b2V5oiQ5YqfJykKICAgICAgICAgICAgICAgICAgIC8v55m75b2V5oiQ5Yqf5LmL5ZCO5bCG5ZCO56uv6L+U5Zue55qEdG9rZW7lrZjlgqjliLBWVUVY5LitCiAgICAgICAgICAgICAgICAgICB0aGlzLiRzdG9yZS5jb21taXQoJ3NldFVzZXInLCBkYXRhLmRhdGEpCiAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgIC8v55m75b2V5oiQ5Yqf5ZCO6Lez6L2s5Yiw5LmL5YmN55qE6aG16Z2iCiAgICAgICAgICAgICAgICAgICB0aGlzLiRyb3V0ZXIuYmFjaygpOwogICAgICAgICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgICAgICAgICAgIHRoaXMuJHRvYXN0LmZhaWwoJ+eZu+W9leWksei0pScpCiAgICAgICAgICAgICAgIH0KICAgICAgICAgICB9LAogICAgICAgICAgIG9uTG9naW5GYWlsZWQgKGVycm9ySW5mbykgewogICAgICAgICAgICAgICBpZihlcnJvckluZm8uZXJyb3JzWzBdKSB7CiAgICAgICAgICAgICAgICAgICB0aGlzLiR0b2FzdCh7CiAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogZXJyb3JJbmZvLmVycm9yc1swXS5tZXNzYWdlLAogICAgICAgICAgICAgICAgICAgICAgIHBvc2l0aW9uOiAndG9wJwogICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgfQogICAgICAgICAgIH0sCiAgICAgICAgICAgYXN5bmMgb25TZW5kU21zKCkgewogICAgICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgICAgICAgLy/moKHpqozmiYvmnLrlj7fnoIEKICAgICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuJHJlZnNbJ2xvZ2luLWZvcm0nXS52YWxpZGF0ZSgnbW9iaWxlJyk7CiAgICAgICAgICAgICAgICAgICAvL+agoemqjOmAmui/h+ivt+axguWPkemAgemqjOivgeeggQogICAgICAgICAgICAgICAgICAgdGhpcy5pc0J1dHRvbkRpc2FibGVkID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHNlbmRTbXModGhpcy51c2VyLm1vYmlsZSk7CiAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhyZXMpOwogICAgICAgICAgICAgICAgICAgLy/nn63kv6Hlj5Hlh7rljrvkuobvvIzpmpDol4/lj5HpgIHmjInpkq7vvIzmmL7npLrlgJLorqHml7YKICAgICAgICAgICAgICAgICAgIGlmKHJlcy5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXNDb3VudGRvd25TaG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgICAgICAgICAgICAgICB0aGlzLiR0b2FzdCh7CiAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogZXJyLm1lc3NhZ2UsCiAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICd0b3AnCiAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgIC8v5peg6K666aqM6K+B56CB5Y+R6YCB5oiQ5Yqf6L+Y5piv5aSx6LSl6YO96KaB6K6+572u5oyJ6ZKu55qEZGlzYWJsZWTlsZ7mgKfkuLpmYWxzZQogICAgICAgICAgICAgICB0aGlzLmlzQnV0dG9uRGlzYWJsZWQgPSBmYWxzZTsKICAgICAgICAgICB9LAogICAgICAgICAgIGNvdW50RG93bkZpbmlzaGVkKCkgewogICAgICAgICAgICAgICAvL+WAkuiuoeaXtuWujOaIkOWQjumakOiXjwogICAgICAgICAgICAgICB0aGlzLmlzQ291bnRkb3duU2hvdyA9IGZhbHNlOwogICAgICAgICAgIH0KICAgICAgICB9LAogICAgfQo="},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/views/login","sourcesContent":["<template>\n    <div class=\"login\">\n        <van-nav-bar\n            right-text=\"遇到问题\"\n            left-arrow\n            @click-right=\"$router.push({name: 'login-question'})\"\n            @click-left=\"$router.back()\"\n        />\n        <div class=\"login-header\">\n             <van-row type=\"flex\" align=\"center\">\n                <van-col span=\"3\">\n                    <img src=\"http://sf3-dycdn-tos.pstatp.com/obj/eden-cn/uhbfnupkbps/toutiao_favicon.ico\" class=\"login_img\" alt=\"\">\n                </van-col>\n                <van-col>\n                    <span class=\"login_title\">手机登录</span>\n                </van-col>\n            </van-row>\n            <van-row>\n                <van-col class=\"login_contract\">\n                    登录即表示同意\n                    <router-link class=\"user_agreement\" to=\"/user_agreement\">\"用户协议\"</router-link>\n                    和\n                    <router-link class=\"privacy_policy\" to=\"/privacy_protection\">\"隐私政策\"</router-link>\n                </van-col>\n            </van-row>\n        </div>\n        <div class=\"login-form\">\n            <van-form \n            :show-error=\"false\" \n            :show-error-message=\"false\" \n            validate-first\n            ref=\"login-form\"\n            @submit=\"onLogin\"\n            @failed=\"onLoginFailed\">\n                <van-field\n                    v-model=\"user.mobile\"\n                    placeholder=\"请输入手机号\"\n                    :rules=\"formRules.mobile\"\n                    name=\"mobile\"\n                />\n                <van-field\n                    v-model=\"user.code\"\n                    placeholder=\"请输入6位验证码\"\n                    :rules=\"formRules.code\"\n                    name=\"vode\"\n                >\n                    <template #button>\n                        <van-count-down v-if=\"isCountdownShow\" :time=\"time\" @finish=\"countDownFinished\" class=\"count-down\" format=\"ss 秒后重新获取\" />\n                        <van-button v-else size=\"small\" type=\"info\" :disabled=\"isButtonDisabled\" @click.prevent=\"onSendSms\">发送验证码</van-button>\n                    </template>\n                </van-field>\n                <div class=\"login-terms login_contract\">\n                    未注册的手机号验证通过后将自动注册\n                </div>\n                <div class=\"login-btn\">\n                    <van-button type=\"info\" block>登录</van-button>\n                </div>\n            </van-form>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { login, sendSms } from '@/api/user';\n    export default {\n        name: 'login',\n        data() {\n            return {\n                time: 1000 * 60,\n                isCountdownShow: false,\n                isButtonDisabled: false,\n                user: {\n                    mobile: '',\n                    code: ''\n                },\n                formRules: {\n                    mobile: [\n                        { required: true, message: '请输入手机号' },\n                        { pattern: /^1[34578]\\d{9}$/, message: '手机号格式错误' }\n                    ],\n                    code: [\n                        { required: true, message: '请输入6位验证码' },\n                        { pattern: /^\\d{6}$/, message: '验证码为6位数字' }\n                    ]\n                }\n            }\n        },\n        methods: {\n           async onLogin() {\n\n               this.$toast.loading({\n                   message: '登录中...',\n                   forbidClick: true,\n                   duration: 0\n               })\n\n               try {\n                   const { data } = await login(this.user);\n                   //console.log(res);\n                   this.$toast.success('登录成功')\n                   //登录成功之后将后端返回的token存储到VUEX中\n                   this.$store.commit('setUser', data.data)\n                   \n                   //登录成功后跳转到之前的页面\n                   this.$router.back();\n               } catch (err) {\n                   this.$toast.fail('登录失败')\n               }\n           },\n           onLoginFailed (errorInfo) {\n               if(errorInfo.errors[0]) {\n                   this.$toast({\n                       message: errorInfo.errors[0].message,\n                       position: 'top'\n                   })\n               }\n           },\n           async onSendSms() {\n               try {\n                   //校验手机号码\n                   await this.$refs['login-form'].validate('mobile');\n                   //校验通过请求发送验证码\n                   this.isButtonDisabled = true;\n                   const res = await sendSms(this.user.mobile);\n                   console.log(res);\n                   //短信发出去了，隐藏发送按钮，显示倒计时\n                   if(res.status === 200) {\n                       this.isCountdownShow = true;\n                   }\n               } catch (err) {\n                   this.$toast({\n                       message: err.message,\n                       position: 'top'\n                   })\n               }\n               //无论验证码发送成功还是失败都要设置按钮的disabled属性为false\n               this.isButtonDisabled = false;\n           },\n           countDownFinished() {\n               //倒计时完成后隐藏\n               this.isCountdownShow = false;\n           }\n        },\n    }\n</script>\n\n<style lang=\"less\" scoped>\n.login-header, .login-form {\n    margin: 40px 30px;\n}\n.login_img {\n    width: 30px;\n    height: 30px;\n}\n.login-terms.login_contract {\n    margin: 20px 0;\n    font-size: 12px;\n}\n.login_title {\n    font-size: 26px;\n    letter-spacing: 2px;\n    color: #232323;\n}\n.login_contract {\n    font-size: 14px;\n    color: #959595;\n}\n.user_agreement, .privacy_policy {\n    color: #676767;\n    cursor: pointer;\n}\n.count-down {\n    color: #676767;\n}\n</style>"]}]}