{"remainingRequest":"/Users/mikyyz/vue-trip/toutiao-m/node_modules/babel-loader/lib/index.js!/Users/mikyyz/vue-trip/toutiao-m/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/mikyyz/vue-trip/toutiao-m/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/mikyyz/vue-trip/toutiao-m/src/views/login/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/mikyyz/vue-trip/toutiao-m/src/views/login/index.vue","mtime":1601834783802},{"path":"/Users/mikyyz/vue-trip/toutiao-m/.babelrc","mtime":1600614206934},{"path":"/Users/mikyyz/vue-trip/toutiao-m/node_modules/cache-loader/dist/cjs.js","mtime":1599750694245},{"path":"/Users/mikyyz/vue-trip/toutiao-m/node_modules/babel-loader/lib/index.js","mtime":1590300945779},{"path":"/Users/mikyyz/vue-trip/toutiao-m/node_modules/cache-loader/dist/cjs.js","mtime":1599750694245},{"path":"/Users/mikyyz/vue-trip/toutiao-m/node_modules/vue-loader/lib/index.js","mtime":1599750700770}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiL1VzZXJzL21pa3l5ei92dWUtdHJpcC90b3V0aWFvLW0vbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwovLwppbXBvcnQgeyBsb2dpbiwgc2VuZFNtcyB9IGZyb20gJ0AvYXBpL3VzZXInOwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ2xvZ2luJywKICBkYXRhOiBmdW5jdGlvbiBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdGltZTogMTAwMCAqIDYwLAogICAgICBpc0NvdW50ZG93blNob3c6IGZhbHNlLAogICAgICBpc0J1dHRvbkRpc2FibGVkOiBmYWxzZSwKICAgICAgdXNlcjogewogICAgICAgIG1vYmlsZTogJycsCiAgICAgICAgY29kZTogJycKICAgICAgfSwKICAgICAgZm9ybVJ1bGVzOiB7CiAgICAgICAgbW9iaWxlOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWl5omL5py65Y+3JwogICAgICAgIH0sIHsKICAgICAgICAgIHBhdHRlcm46IC9eMVszNDU3OF1cZHs5fSQvLAogICAgICAgICAgbWVzc2FnZTogJ+aJi+acuuWPt+agvOW8j+mUmeivrycKICAgICAgICB9XSwKICAgICAgICBjb2RlOiBbewogICAgICAgICAgcmVxdWlyZWQ6IHRydWUsCiAgICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWlNuS9jemqjOivgeeggScKICAgICAgICB9LCB7CiAgICAgICAgICBwYXR0ZXJuOiAvXlxkezZ9JC8sCiAgICAgICAgICBtZXNzYWdlOiAn6aqM6K+B56CB5Li6NuS9jeaVsOWtlycKICAgICAgICB9XQogICAgICB9CiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgb25Mb2dpbjogZnVuY3Rpb24gb25Mb2dpbigpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUoKSB7CiAgICAgICAgdmFyIF95aWVsZCRsb2dpbiwgZGF0YTsKCiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgICBzd2l0Y2ggKF9jb250ZXh0LnByZXYgPSBfY29udGV4dC5uZXh0KSB7CiAgICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgICAgX3RoaXMuJHRvYXN0LmxvYWRpbmcoewogICAgICAgICAgICAgICAgICBtZXNzYWdlOiAn55m75b2V5LitLi4uJywKICAgICAgICAgICAgICAgICAgZm9yYmlkQ2xpY2s6IHRydWUsCiAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAwCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgICBfY29udGV4dC5wcmV2ID0gMTsKICAgICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA0OwogICAgICAgICAgICAgICAgcmV0dXJuIGxvZ2luKF90aGlzLnVzZXIpOwoKICAgICAgICAgICAgICBjYXNlIDQ6CiAgICAgICAgICAgICAgICBfeWllbGQkbG9naW4gPSBfY29udGV4dC5zZW50OwogICAgICAgICAgICAgICAgZGF0YSA9IF95aWVsZCRsb2dpbi5kYXRhOwoKICAgICAgICAgICAgICAgIC8vY29uc29sZS5sb2cocmVzKTsKICAgICAgICAgICAgICAgIF90aGlzLiR0b2FzdC5zdWNjZXNzKCfnmbvlvZXmiJDlip8nKTsgLy/nmbvlvZXmiJDlip/kuYvlkI7lsIblkI7nq6/ov5Tlm57nmoR0b2tlbuWtmOWCqOWIsFZVRVjkuK0KCgogICAgICAgICAgICAgICAgX3RoaXMuJHN0b3JlLmNvbW1pdCgnc2V0VXNlcicsIGRhdGEuZGF0YSk7IC8v55m75b2V5oiQ5Yqf5ZCO6Lez6L2s5Yiw5LmL5YmN55qE6aG16Z2iCgoKICAgICAgICAgICAgICAgIF90aGlzLiRyb3V0ZXI7CiAgICAgICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gMTQ7CiAgICAgICAgICAgICAgICBicmVhazsKCiAgICAgICAgICAgICAgY2FzZSAxMToKICAgICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSAxMTsKICAgICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oMSk7CgogICAgICAgICAgICAgICAgX3RoaXMuJHRvYXN0LmZhaWwoJ+eZu+W9leWksei0pScpOwoKICAgICAgICAgICAgICBjYXNlIDE0OgogICAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgICByZXR1cm4gX2NvbnRleHQuc3RvcCgpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSwgX2NhbGxlZSwgbnVsbCwgW1sxLCAxMV1dKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgb25Mb2dpbkZhaWxlZDogZnVuY3Rpb24gb25Mb2dpbkZhaWxlZChlcnJvckluZm8pIHsKICAgICAgaWYgKGVycm9ySW5mby5lcnJvcnNbMF0pIHsKICAgICAgICB0aGlzLiR0b2FzdCh7CiAgICAgICAgICBtZXNzYWdlOiBlcnJvckluZm8uZXJyb3JzWzBdLm1lc3NhZ2UsCiAgICAgICAgICBwb3NpdGlvbjogJ3RvcCcKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIG9uU2VuZFNtczogZnVuY3Rpb24gb25TZW5kU21zKCkgewogICAgICB2YXIgX3RoaXMyID0gdGhpczsKCiAgICAgIHJldHVybiBfYXN5bmNUb0dlbmVyYXRvciggLyojX19QVVJFX18qL3JlZ2VuZXJhdG9yUnVudGltZS5tYXJrKGZ1bmN0aW9uIF9jYWxsZWUyKCkgewogICAgICAgIHZhciByZXM7CiAgICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUyJChfY29udGV4dDIpIHsKICAgICAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQyLnByZXYgPSBfY29udGV4dDIubmV4dCkgewogICAgICAgICAgICAgIGNhc2UgMDoKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5wcmV2ID0gMDsKICAgICAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gMzsKICAgICAgICAgICAgICAgIHJldHVybiBfdGhpczIuJHJlZnNbJ2xvZ2luLWZvcm0nXS52YWxpZGF0ZSgnbW9iaWxlJyk7CgogICAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICAgIC8v5qCh6aqM6YCa6L+H6K+35rGC5Y+R6YCB6aqM6K+B56CBCiAgICAgICAgICAgICAgICBfdGhpczIuaXNCdXR0b25EaXNhYmxlZCA9IHRydWU7CiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDY7CiAgICAgICAgICAgICAgICByZXR1cm4gc2VuZFNtcyhfdGhpczIudXNlci5tb2JpbGUpOwoKICAgICAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgICAgICByZXMgPSBfY29udGV4dDIuc2VudDsKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlcyk7IC8v55+t5L+h5Y+R5Ye65Y675LqG77yM6ZqQ6JeP5Y+R6YCB5oyJ6ZKu77yM5pi+56S65YCS6K6h5pe2CgogICAgICAgICAgICAgICAgaWYgKHJlcy5zdGF0dXMgPT09IDIwMCkgewogICAgICAgICAgICAgICAgICBfdGhpczIuaXNDb3VudGRvd25TaG93ID0gdHJ1ZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBfY29udGV4dDIubmV4dCA9IDE0OwogICAgICAgICAgICAgICAgYnJlYWs7CgogICAgICAgICAgICAgIGNhc2UgMTE6CiAgICAgICAgICAgICAgICBfY29udGV4dDIucHJldiA9IDExOwogICAgICAgICAgICAgICAgX2NvbnRleHQyLnQwID0gX2NvbnRleHQyWyJjYXRjaCJdKDApOwoKICAgICAgICAgICAgICAgIF90aGlzMi4kdG9hc3QoewogICAgICAgICAgICAgICAgICBtZXNzYWdlOiBfY29udGV4dDIudDAubWVzc2FnZSwKICAgICAgICAgICAgICAgICAgcG9zaXRpb246ICd0b3AnCiAgICAgICAgICAgICAgICB9KTsKCiAgICAgICAgICAgICAgY2FzZSAxNDoKICAgICAgICAgICAgICAgIC8v5peg6K666aqM6K+B56CB5Y+R6YCB5oiQ5Yqf6L+Y5piv5aSx6LSl6YO96KaB6K6+572u5oyJ6ZKu55qEZGlzYWJsZWTlsZ7mgKfkuLpmYWxzZQogICAgICAgICAgICAgICAgX3RoaXMyLmlzQnV0dG9uRGlzYWJsZWQgPSBmYWxzZTsKCiAgICAgICAgICAgICAgY2FzZSAxNToKICAgICAgICAgICAgICBjYXNlICJlbmQiOgogICAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LCBfY2FsbGVlMiwgbnVsbCwgW1swLCAxMV1dKTsKICAgICAgfSkpKCk7CiAgICB9LAogICAgY291bnREb3duRmluaXNoZWQ6IGZ1bmN0aW9uIGNvdW50RG93bkZpbmlzaGVkKCkgewogICAgICAvL+WAkuiuoeaXtuWujOaIkOWQjumakOiXjwogICAgICB0aGlzLmlzQ291bnRkb3duU2hvdyA9IGZhbHNlOwogICAgfQogIH0KfTs="},{"version":3,"sources":["index.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div class=\"login\">\n        <van-nav-bar\n            right-text=\"遇到问题\"\n            left-arrow\n            @click-right=\"$router.push({name: 'login-question'})\"\n            @click-left=\"$router.back()\"\n        />\n        <div class=\"login-header\">\n             <van-row type=\"flex\" align=\"center\">\n                <van-col span=\"3\">\n                    <img src=\"http://sf3-dycdn-tos.pstatp.com/obj/eden-cn/uhbfnupkbps/toutiao_favicon.ico\" class=\"login_img\" alt=\"\">\n                </van-col>\n                <van-col>\n                    <span class=\"login_title\">手机登录</span>\n                </van-col>\n            </van-row>\n            <van-row>\n                <van-col class=\"login_contract\">\n                    登录即表示同意\n                    <router-link class=\"user_agreement\" to=\"/user_agreement\">\"用户协议\"</router-link>\n                    和\n                    <router-link class=\"privacy_policy\" to=\"/privacy_protection\">\"隐私政策\"</router-link>\n                </van-col>\n            </van-row>\n        </div>\n        <div class=\"login-form\">\n            <van-form \n            :show-error=\"false\" \n            :show-error-message=\"false\" \n            validate-first\n            ref=\"login-form\"\n            @submit=\"onLogin\"\n            @failed=\"onLoginFailed\">\n                <van-field\n                    v-model=\"user.mobile\"\n                    placeholder=\"请输入手机号\"\n                    :rules=\"formRules.mobile\"\n                    name=\"mobile\"\n                />\n                <van-field\n                    v-model=\"user.code\"\n                    placeholder=\"请输入6位验证码\"\n                    :rules=\"formRules.code\"\n                    name=\"vode\"\n                >\n                    <template #button>\n                        <van-count-down v-if=\"isCountdownShow\" :time=\"time\" @finish=\"countDownFinished\" class=\"count-down\" format=\"ss 秒后重新获取\" />\n                        <van-button v-else size=\"small\" type=\"info\" :disabled=\"isButtonDisabled\" @click.prevent=\"onSendSms\">发送验证码</van-button>\n                    </template>\n                </van-field>\n                <div class=\"login-terms login_contract\">\n                    未注册的手机号验证通过后将自动注册\n                </div>\n                <div class=\"login-btn\">\n                    <van-button type=\"info\" block>登录</van-button>\n                </div>\n            </van-form>\n        </div>\n    </div>\n</template>\n\n<script>\nimport { login, sendSms } from '@/api/user';\n    export default {\n        name: 'login',\n        data() {\n            return {\n                time: 1000 * 60,\n                isCountdownShow: false,\n                isButtonDisabled: false,\n                user: {\n                    mobile: '',\n                    code: ''\n                },\n                formRules: {\n                    mobile: [\n                        { required: true, message: '请输入手机号' },\n                        { pattern: /^1[34578]\\d{9}$/, message: '手机号格式错误' }\n                    ],\n                    code: [\n                        { required: true, message: '请输入6位验证码' },\n                        { pattern: /^\\d{6}$/, message: '验证码为6位数字' }\n                    ]\n                }\n            }\n        },\n        methods: {\n           async onLogin() {\n\n               this.$toast.loading({\n                   message: '登录中...',\n                   forbidClick: true,\n                   duration: 0\n               })\n\n               try {\n                   const { data } = await login(this.user);\n                   //console.log(res);\n                   this.$toast.success('登录成功')\n                   //登录成功之后将后端返回的token存储到VUEX中\n                   this.$store.commit('setUser', data.data)\n                   \n                   //登录成功后跳转到之前的页面\n                   this.$router\n               } catch (err) {\n                   this.$toast.fail('登录失败')\n               }\n           },\n           onLoginFailed (errorInfo) {\n               if(errorInfo.errors[0]) {\n                   this.$toast({\n                       message: errorInfo.errors[0].message,\n                       position: 'top'\n                   })\n               }\n           },\n           async onSendSms() {\n               try {\n                   //校验手机号码\n                   await this.$refs['login-form'].validate('mobile');\n                   //校验通过请求发送验证码\n                   this.isButtonDisabled = true;\n                   const res = await sendSms(this.user.mobile);\n                   console.log(res);\n                   //短信发出去了，隐藏发送按钮，显示倒计时\n                   if(res.status === 200) {\n                       this.isCountdownShow = true;\n                   }\n               } catch (err) {\n                   this.$toast({\n                       message: err.message,\n                       position: 'top'\n                   })\n               }\n               //无论验证码发送成功还是失败都要设置按钮的disabled属性为false\n               this.isButtonDisabled = false;\n           },\n           countDownFinished() {\n               //倒计时完成后隐藏\n               this.isCountdownShow = false;\n           }\n        },\n    }\n</script>\n\n<style lang=\"less\" scoped>\n.login-header, .login-form {\n    margin: 40px 30px;\n}\n.login_img {\n    width: 30px;\n    height: 30px;\n}\n.login-terms.login_contract {\n    margin: 20px 0;\n    font-size: 12px;\n}\n.login_title {\n    font-size: 26px;\n    letter-spacing: 2px;\n    color: #232323;\n}\n.login_contract {\n    font-size: 14px;\n    color: #959595;\n}\n.user_agreement, .privacy_policy {\n    color: #676767;\n    cursor: pointer;\n}\n.count-down {\n    color: #676767;\n}\n</style>"],"sourceRoot":"src/views/login"}]}